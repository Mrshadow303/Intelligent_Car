# 

# 一、项目主要内容

本项目主要实现了智能小车的循迹与避障功能，旨在提升小车的自动化程度与智能化水平，使其在复杂环境中能够自主运动。

### 1. 智能小车循迹

#### 1.1 循迹功能描述

智能小车的循迹功能使其能够在白色地面上的黑色轨迹线引导下平稳前行。理想状态下，小车会始终紧贴黑线。当小车遇到曲线路段时，它会通过传感器进行实时检测，并相应地向两侧原地转向以探测黑线的方向，一旦重新找到黑线，小车将会立即恢复沿线前进的状态。此功能依赖于高精度的红外传感器与控制算法的结合，确保小车能够在各种曲线和复杂环境下稳定运行。

#### 1.2 循迹解决的问题

循迹功能解决了小车在人工控制下难以实现的精确寻路问题。通过高效的传感器和控制系统，小车能够实时调整自身的运动方向，从而防止偏离轨道。这一机制不仅提升了小车的智能性，还为后续的自动驾驶技术提供了基础。

### 2. 智能小车避障

#### 2.1 避障功能描述

在执行避障功能时，小车通过键盘远程输入指令进行控制。基本操作通过键盘的
w, a, s, d
键实现前后左右的移动，同时添加了一键停车功能。具体的按键对应关系如下：

- w: 前进

- s: 后退

- a: 左转

- d: 右转

- space: 停止

小车在键盘控制下可以按照指令灵活运动，运动过程中通过超声波传感器实时获取前方障碍物的距离。当小车与障碍物的距离小于设定阈值（本项目设定为20cm）时，小车将根据预设的判断逻辑自动减速并停车避障。此时，小车会等待障碍物消失或控制者可以通过键盘重新发出指令，以便对小车的行进方向进行调整，确保小车在复杂环境中能够灵活避开障碍。

总之，避障功能通过程序设计实现了小车的基本控制，并有效防止小车在运动中与障碍物发生碰撞，保证了小车的安全性和稳定性。

#### 2.2 避障解决的问题

避障功能解决了小车在人工控制下与障碍物发生碰撞的风险。通过超声波传感器的实时监测和反馈，当小车接近障碍物时，系统留给控制者充足的时间进行干预，提升了操作的安全性与灵活性。此外，该功能也为小车在未来的自主导航与智能决策提供了基础支持。

**二、项目方案和相关技术**

**1.设计思路与软件实现**

![](file:///C:/Users/MRshadow/Desktop/study.avi/%E5%A4%A7%E5%9B%9B%E4%B8%8A/%E6%99%BA%E8%83%BD%E8%BD%A6/%E9%A1%B9%E7%9B%AE/images/%E5%9B%BE%E7%89%871.png "全代码截图")

图 1 全代码截图

**1.1智能小车循迹**

![](file:///C:/Users/MRshadow/Desktop/study.avi/%E5%A4%A7%E5%9B%9B%E4%B8%8A/%E6%99%BA%E8%83%BD%E8%BD%A6/%E9%A1%B9%E7%9B%AE/images/%E5%9B%BE%E7%89%872.png "手动控制"){width="6.353472222222222in"
height="4.1506944444444445in"}

图 2 手动控制

代码中保留了wasd手动操控方向的功能。连接上机器人主机，先设置好前后左右与停止这几个基本功能的轮子速度。然后，将所有控制轮子舵机速度点代码块通过与并赋值给左轮与右轮，将两部分数据共同输入到机器人驱动器（连接舵机端口）。

![](file:///C:/Users/MRshadow/Desktop/study.avi/%E5%A4%A7%E5%9B%9B%E4%B8%8A/%E6%99%BA%E8%83%BD%E8%BD%A6/%E9%A1%B9%E7%9B%AE/images/%E5%9B%BE%E7%89%873.png "自动寻迹")

图 3 自动寻迹逻辑

循迹时，通过变量stopBarrier来优先避障，变量isRightWay判断当前小车是否在正确的路径上，变量timer实现对左转计时（这里不用定时器的原因是因为定时器无法跳出）。小车会通过光电传感器持续检测小车下方的道路颜色（黑/白），如果是黑色，并且显示在正确路径上，那么直行；如果不是黑色，但显示在正确路径上，那么说明小车刚好开到了正确路径之外，将isRightWay置为0，同时将timer归零，准备计时；继续监测，如果路径不是黑色，也不再正确路径上，优先向左寻迹，timer在每一次光电传感器检测时递增，利用timer控制左转的时间，之后再向右寻迹，直到找到黑色路径；在左寻迹或右寻迹中，检测道路为黑色，并且此时isRightWay

为0，说明从错误道路回到了正确道理，将isRightWay置为1。循环以上检测步骤。

行打印用于观测数据是否正常。

**1.2智能小车避障**

![](file:///C:/Users/MRshadow/Desktop/study.avi/%E5%A4%A7%E5%9B%9B%E4%B8%8A/%E6%99%BA%E8%83%BD%E8%BD%A6/%E9%A1%B9%E7%9B%AE/images/%E5%9B%BE%E7%89%874.png "简单避障")

图 4 小车避障代码

避障部分使用到机器人距离传感器。通过从对应端口接收到的距离数据，判断当距离小于阈值时，停车避障。当返回值value&lt;20
时，小车进行自动避障功能，将变量stopBarrier置为1，用于停止其他线路的动作，再分别给两轮赋值0，停车避障。在避障过程中可以通过移动障碍物使value&gt;20来重新启动，将stopBarrier置为1，解锁其他线路；或者手动使用wasd按键进行手动操控避障。



**2.传感器的具体应用方法：**

**光电循迹传感器：**

利用光电效应探测信号。光电传感器由一个光源发射器和一个光电接收器组成，发射器发出一定波长的光线，当检测方向遇到障碍物（反射面）时，光线反射回来被接收器接收。光电传感器采用主动光源反射探测，目标的反射率和形状是探测距离的关键。光电传感器及其路径识别原理光电探测法，即利用光线在不同颜色的物体表面具有不同的反射强度的特点，在小车行驶过程中不断地向地面发射光线，如果遇到黑线则光线被吸收，小车上的接收器接收不到或接收到很弱的反射光。单片机以是否收到反射回来的光线为依据来确定黑线的位置和小车的行走路线。因此，在本实验中，当检测到黑胶布（赛道）时，由于反射率低，光电传感器由于无法接收到返回的光线，将输出开关信号。光电传感器采集到黑色物体时，传感器的值将会在0和1之间变化。

**超声波测距传感器：**

小车前端安装一个超声波避障传感器模块，可以测量机器人与障碍物之间的距离（返回值单位：cm）。超声波传感器有两个端口，一个发射超声波，一个接收超声波。超声波测距模块包括超声波发射器、接收器与控制电路。若前方有障碍物，超声波将会反射回来，通过计算收发间隔时间可以计算出前方障碍物的距离。


